# Linux Enumeration

## User Enumeration

Who we are? Are we a member of an interesting group? what can we run as sudo?
```bash
whoami

id

sudo -l #Check sudo version
```

Are there more users on the machine? Maybe some service-users?

```bash
cat /etc/passwd
```

## Sensitive Files & interesting folders

```bash
/etc/passwd
/etc/shadow
/var/backup
```
_____

## OS Version and Architecture

Does the name of the host reveals some functional roles (SRV, DB,WEB...) or any pattern client(n), client(n+1).. that could help discover additional machines?

```bash
hostname
```

How old is the kernel/OS? May we find some exploits?

```bash
cat /etc/issue #OS Version

cat /etc/*-release #OS Version

uname -a #Kernel Version
```

_____

## Running Processes and Services

Is there any process or service that might allow us to elevate privileges?

```bash
ps aux
```

**Note:** Process must run as privileged user.

_____

## Networking information

Do we have access to other networks (to pivot)? If true, how do we route the traffic?

```bash
#Depending on the Linux version:
ip a
ifconfig -a

#Depending on the Linux version:
route
routel
```

Which ports are open? Is any of those ports only available through the loopback address?

```bash
#View active network connections:
netstat -anp
netstat -antup
ss -anp
```

_____

## Firewall status and Rules

Is there any service running on the machine blocked by the firewall and only accessible by the loopback address? Can we gather information about inbound/outbound filtering (to facilitate port forwarding and tunneling while pivoting)?

```bash
#On Linux systems we need root permissions to view iptables rules. However, we can search for specific files with weak permissions:
/etc/iptables #View files inside thi directory.
find / -name "iptables" #Review this instruction
```

_____

## Scheduled Tasks

Are there any scheduled task on the machine? Does it contain any misconfigured permission?

```bash
#Timer scheduled tasks:
ls -lah /etc/cron*

#Specific scheduled tasks:
cat /etc/crontab

#Inspect cron log file for running cron jobs:
grep "CRON" /var/log/cron.log
```

_____

## Installed Applications and patch levels

Which applications are installed on the system? Are these outdated and vulnerable?

```bash
#List applications installed by dpkg (debian):
dpkg -l
```

_____

## R/W Files and Directories

Is there any world readable file/directory where we can obtain information? Is there any world writable file/directory that we can modify (executed under the context of a privileged user)?

```bash
find / -writable -type d 2>/dev/null
#Always ./bin, ../local/bin are interesting ones.
```

_____

## Unmounted Filesystems

Are there any unmounted disk? If we find one, mount it and enumerate for interesting information:

```bash
mount -l #List all mounted filesystems

cat /etc/fstab #List all drives that will be mounted at boot time.

/bin/lsblk # View all available disks

```

_____

## Kernel Modules

Are there any kernel modules vulnerable on the system that we can exploit?

```bash
#Enumerate loaded Kernel modules:
lsmod

#Given the list of loaded Kernel modules, we can view more information about an specific module:
/sbin/modinfo $MODULENAME
```

_____

## SUID Binaries

Is there any binary with suid permissions set?

```bash
find / -perm -u=s -type f 2>/dev/null
```

Another way to look at it:

```bash
#printf shows the output with file(f), path(p), user(u), group(g) and permissions(m) in various columns (column -t):
find \ -perm -4000 -printf '%f\t%p\t%u\t%g\t%m\n' 2>/dev/null | column -t
#We can also specify the above command with a grep in order to see non root  SUID binaries:
find \ -perm -4000 -printf '%f\t%p\t%u\t%g\t%m\n' 2>/dev/null | column -t | grep -v "root"
```

### **SUIDs to Root:**

* /usr/bin/cp
_____

## Find more at:

* [g0tmi1k Basic Linux Privesc](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)
